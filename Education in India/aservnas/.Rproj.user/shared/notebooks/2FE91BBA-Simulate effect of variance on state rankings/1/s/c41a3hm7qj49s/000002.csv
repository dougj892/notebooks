"0",""
"0","library(tidyverse)"
"0",""
"0","# Inputs -- using state reading changes for now"
"0","n <- 100000"
"0","centile <- .25"
"0",""
"0","### STATE READING CHANGES ###"
"0","# var_pers <- 0.004025697"
"0","# var_trans <- 3.57E-04	+ 0.002289197"
"0","# "
"0",""
"0",""
"0","### STATE READING LEVELS ####"
"0","var_pers <- 0.016474368"
"0","var_trans <- 1.78E-04 +	0.001144598"
"0",""
"0","var_pers / (var_pers + var_trans)"
"1","[1]"
"1"," 0.9256841"
"1","
"
"0","# with normal distribution"
"0","df <- tibble(pers = rnorm(n, mean = 0, sd = var_pers^.5),"
"0","             trans = rnorm(n, mean = 0, sd = var_trans^.5))"
"0",""
"0","# with beta distribution"
"0","# note that if mean = .5 then shape1 =  shape2 with the beta"
"0","# shape_pers <- (1/(4*var_pers))-.5"
"0","# shape_trans <- (1/(4*var_trans))-.5"
"0","# df <- tibble(pers = rbeta(n, shape_pers, shape_pers),"
"0","#              trans = rbeta(n, shape_trans, shape_trans))"
"0",""
"0","# with the t distribution"
"0","# "
"0","# df_pers <- 3"
"0","# df_trans <- 4"
"0","# df <- tibble(pers = rt(n, df_pers),"
"0","#              trans = rt(n, df_trans))"
"0",""
"0",""
"0","df <- df %>%"
"0","  mutate(y = pers +trans)"
"0","  "
"0","df$y_rank[order(df$y)] <- 1:nrow(df)"
"2","Unknown or uninitialised column: 'y_rank'."
"0","df$pers_rank[order(df$pers)] <- 1:nrow(df)"
"2","Unknown or uninitialised column: 'pers_rank'."
"0","df <- df %>%"
"0","  mutate(top_cent_pers = (pers_rank > (1-centile)*n), top_cent_y = (y_rank > (1-centile)*n))"
"0",""
"0","# Proportion of those ranking in the top which should be ranking in top quartile"
"0","mean(df$top_cent_pers[df$top_cent_y])"
"1","[1]"
"1"," 0.85728"
"1","
"
