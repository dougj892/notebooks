---
title: "Explore Barro and Lee Data"
output: html_notebook
---

This notebook provides an overview of the Barro and Lee data and performs basic exploratory analysis of the data. Barro and Lee have compiled comprehensive and comparable stats on education attainment for a variety of countries. For more info, see the Barro and Lee website [here](http://www.barrolee.com/). For a detailed list of their data sources for each country, check out the footnotes Excel doc in the same data folder. For even more info, check out their paper describing the dataset [here](https://www.nber.org/papers/w15902.pdf)

## Different datasets
Barro and Lee have created separate datasets for population 25+, population 15+, and by 5-year age group. In addition, for each of those categories, there are separate datasets for the total population and just men or women (and for different data formats). 

From what I can tell, the datasets for population 25+ and population 15+ are just subsets of the dataset for each 5 year age group so I mainly use that dataset: **BL2013_MF_v2.2**. I use the Stata format 

```{r setup, results='hide'}
library(tidyverse)
library(haven)
bl_path <- "C:/Users/dougj/Documents/Data/Education/Barro and Lee"
bl <- read_dta(file.path(bl_path, "BL2013_MF_v2.2.dta"))

```

Print the variable labels from Stata
```{r}
for (var in names(bl)) {
  print(paste(var, ": ", attributes(bl[[var]])$label))
}
```

## Understanding the variables
Note that the variables in the dataset are a little confusing. For example, it is unclear it is unclear whether "lp" refers to the proportion of the population with only some primary or the proportion who have achieved at least some primary. I found [this blog post](http://devecondata.blogspot.com/2008/07/barro-lee-dataset.html) helpful. In particular, they mention that the sum of variables LU, LP, LS, and LH is 100.  

This means, for example, that lp refers to the proportion of the population with at least some primary but no secondary or higher. 

Or, for example, to get the proportion of people who have at least completed primary you should take lpc+ls+lh

```{r}
bl <- bl %>% mutate(total = lu+lp+ls+lh, temp = lpc+lsc+lhc)
```


Create a graph showing average years of schooling by region. First get the figure for each country and then take the average across countries. Otherwise, the final figure would be mainly due to whatever happened in India and China. I only look adults under 40 because otherwise the changes would lag actual changes quite a bit.

*Note: Oddly, average schooling in developing countries goes up if you include older people (40+).  If education is increasing over time, you would expect that not to be the case.  This 

```{r}
bl_agg <- bl %>% 
  filter(ageto <= 40) %>% 
  group_by(region_code, country, year) %>% 
  summarize(years_schooling = weighted.mean(yr_sch, w = pop)) %>% 
  ungroup() %>% 
  group_by(region_code, year) %>% 
  summarise(years_schooling = mean(years_schooling))

ggplot(bl_agg, aes(year, years_schooling, color = region_code)) +
  geom_line()
```


